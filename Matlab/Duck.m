x=[0.9 1.3 1.9 2.1 2.6 3.0 3.9 4.4 4.7 5.0 6.0 7.0 8.0 9.3 10.4 11.37 11.66 12.05 12.62 13.02 13.3 13 12.7 12.6 12.4 12 11.86 11.66 11.34 11 10.7 10.56 10.5 10.46 10.3 10.1 10 9.7 9.5 9.3 9 8.5 8.3 8 7.5 7.3 7 6.6 6.3 5.92 5.31 5.11 5.1 5.21 5.3 5.34 5.4 5.46 5.5 5.54 5.6 5.6 5.64 5.7 5.71 5.5 5.31 5 4.81 4.6 4.41 4.2 4.12 4.1 3.7 3.41 3.1 2.91 2.7 2.4 2.3 2.21 2.1 1.9 1.71 1.51 1.3 1 0.91];
y=[1.3 1.5 1.85 2.1 2.6 2.7 2.4 2.15 2.05 2.01 2.25 2.3 2.25 1.94 1.45 0.94 0.73 0.6 0.51 0.41 0.25 0.23 0.22 0.23 0.14 -0.028 -0.079 -0.092 -0.12 -0.12 -0.13 -0.07 -0.04 -0.06 -0.19 -0.291 -0.35 -0.42 -0.45 -0.46 -0.38 -0.2 -1 -2 -3 -3.5 -4.5 -5 -5.51 -5.8 -6 -5.9 -5.7 -5.5 -5 -4.5 -4 -3.52 -3 -2.5 -2 -1.5 -1 0 0.2 0.3 0.4 0.5 0.6 0.81 1 1.2 1.21 1.22 1.24 1.27 1.3 1.34 1.35 1.40 1.365 1.31 1.23 1.08 1 1 1 1 1.2];
n = length(x);
for i=1:n-1
    h(i) = x(i+1)-x(i);
end
a = y;
alfa = zeros (n-1,1);
for i=2:n-1
    alfa(i) = (3/h(i))*(a(i+1) - a(i))- (3/h(i-1))*(a(i) - a(i-1));
end
l(1) = 0;
mu(1) = 0;
z(1) = 0;
for i=2:n-1
l(i) = 2*(x(i+1)- x(i-1))- h(i-1)*alfa(i-1);
mu(i) = h(i)/l(i);
z(i) = (alfa(i) - h(i-1)*z(i-1))/l(i);
end
l(91) = 1;
z(91) = 0;
c(91) = 0;
b = zeros(n,1);
d = zeros(n,1);
for j=n-1:-1:1
    c(j) = z(j)- mu(j)*c(j+1);
    b(j) = ((a(j+1) - a(j))/h(j)) - h(j)*(c(j+1) + 2*c(j))/3;
    d(j) = (c(j+1) - c(j))/(3*h(j));
end
for i=1:n-1
    for j=1:n/2
        Y(j) = a(i) + b(i) *(x(j) -x(i)) + c(i)*(x(j) - x(i))^2 + d(i)*(x(j) - x(i))^3;
    end
    hold on 
    plot(x,y,'-','Color','red');
end
hold off